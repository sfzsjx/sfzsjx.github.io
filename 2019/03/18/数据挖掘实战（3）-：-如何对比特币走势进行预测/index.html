<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
    <meta name="description" content="天道酬勤">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    数据挖掘实战（3） ： 如何对比特币走势进行预测 |
    
    上善若水博客</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
  <script src="/js/pace.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>
<main class="content">
  <section class="outer">
  

<article id="post-数据挖掘实战（3）-：-如何对比特币走势进行预测" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      数据挖掘实战（3） ： 如何对比特币走势进行预测
    </h1>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/2019/03/18/数据挖掘实战（3）-：-如何对比特币走势进行预测/" class="article-date">
  <time datetime="2019-03-18T07:11:45.000Z" itemprop="datePublished">2019-03-18</time>
</a>
        
  <div class="article-category">
    <a class="article-category-link" href="/categories/数据分析/">数据分析</a>
  </div>

      </div>
    

    
      




    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>时间序列分析：<br>   时间序列分析模型建立了观察结果与时间变化的关系，能够帮助我们预测未来一段时间内的结果变化情况。</p>
<p>需要掌握的目标：</p>
<ol>
<li>了解时间序列预测的概念，以及常用的算法，包括AR、MA、ARMA、ARIMA模型等；</li>
<li>掌握并使用ARMA模型工具，对一个时间序列数据进行建模和预测；</li>
<li>对比特币的历史数据进行时间序列建模，并预测未来6个月的走势。</li>
</ol>
<p><strong>时间序列预测</strong><br>   关于时间序列，可以简单理解为按照时间组成的数字序列。在时间序列预测模型中，经典模型有：<br>AR、MA、ARIMA、ARMA。<br>   AR(Auto Regressive) 又叫自回归模型。它认为过去若干个时刻的点通过线性组合，再加上白噪声就可以预测未来某个时刻的点。白噪声可以理解成一个期望为0，方差为常数的纯随机过程。AR模型还存在一个阶数，称为 AR（p）模型，也叫做 p 阶自回归模型。他指的是通过这个时刻的前p个点，通过线性组合再加上白噪声来预测当前时刻点的值。</p>
<p>   MA（Moving Average）,又叫滑动平均模型。它与 AR模型大同小异，AR模型是历史时序值的线性组合，MA是通过历史白噪声点进行线性组合来 影响当前时刻点。同样MA模型也存在一个阶数，称为MA(q)阶模型，也叫做q阶移动平均模型。</p>
<p>   ARMA（Auto Regressive Moving Average）,又叫自回归滑动平均模型，也是AR和MA两者的混合。相较于ARMA,ARIMA多了个差分的过程，作用是对不平稳数据进行差分平稳，在差分平稳后再进行建模。ARMA(p,q) 两个阶数，ARIMA（p,d,q）三个阶数，其中d 表示差分阶数。</p>
<p><strong>  ARMA 模型工具</strong><br>  引入相关工具包</p>
<pre><code>  from statsmodels.tsa.arima_model import ARMA

</code></pre><p>然后通过ARMA(endog,order,exog=None)创建ARMA类，参数说明：<br>  endog: endogenous variable,代表内生变量，又叫非政策性变量，它由模型决定，不被政策左右，可以说是我们想要分析的变量，或者说是我们这次项目需要用到的变量。</p>
<p>  order ：代表是p和q的值，也就是ARMA中的阶数。</p>
<p>  exog: exogenous variables,代表外生变量。外生变量和内生变量一样是经济模型中重要变量。相较于内生变量而言，外生变量有称为政策性变量，在经济机制内受外部的影响，不是我们模型要研究的变量。</p>
<p>代码例子：</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt
import statsmodels.api as sm
from statsmodels.tsa.arima_model import ARMA
from statsmodels.graphics.api import qqplot

# 创建数据
data = [5922, 5308, 5546, 5975, 2704, 1767, 4111, 5542, 4726, 5866, 6183, 3199, 1471, 1325, 6618, 6644, 5337, 7064, 2912, 1456, 4705, 4579, 4990, 4331, 4481, 1813, 1258, 4383, 5451, 5169, 5362, 6259, 3743, 2268, 5397, 5821, 6115, 6631, 6474, 4134, 2728, 5753, 7130, 7860, 6991, 7499, 5301, 2808, 6755, 6658, 7644, 6472, 8680, 6366, 5252, 8223, 8181, 10548, 11823, 14640, 9873, 6613, 14415, 13204, 14982, 9690, 10693, 8276, 4519, 7865, 8137, 10022, 7646, 8749, 5246, 4736, 9705, 7501, 9587, 10078, 9732, 6986, 4385, 8451, 9815, 10894, 10287, 9666, 6072, 5418]
data = pd.Series(data)
data_index = sm.tsa.datetools.dates_from_range(&#39;1901&#39;,&#39;1990&#39;)

# 绘制数据图
data.index = pd.Index(data_index)
data.plot(figsize=(12,8))
plt.show()

# 创建 ARMA 模型
arma = ARMA(data,(7,0)).fit()
print(&#39;AIC: %0.4lf&#39;  %arma.aic)

# 模型预测
predict_y = arma.predict(&#39;1990&#39;,&#39;2000&#39;)

# 预测结果绘制
fig,ax = plt.subplots(figsize=(12,8))
ax = data.ix[&#39;1901&#39;:].plot(ax=ax)
predict_y.plot(ax= ax)
plt.show()

</code></pre><p>如何判断一个模型是否合适？<br> 需要引入AIC准则，也叫赤池准则，数值越小代表模型拟合的越好。</p>
<p><strong>比特币预测</strong></p>
<pre><code># -*- coding: utf-8 -*-
# 比特币走势预测，使用时间序列 ARMA
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.arima_model import ARMA
import warnings
from itertools import product
from datetime import datetime
warnings.filterwarnings(&#39;ignore&#39;)
# 数据加载
df = pd.read_csv(&#39;./bitcoin_2012-01-01_to_2018-10-31.csv&#39;)
# 将时间作为 df 的索引
df.Timestamp = pd.to_datetime(df.Timestamp)
df.index = df.Timestamp
# 数据探索
print(df.head())
# 按照月，季度，年来统计
df_month = df.resample(&#39;M&#39;).mean()
df_Q = df.resample(&#39;Q-DEC&#39;).mean()
df_year = df.resample(&#39;A-DEC&#39;).mean()
# 按照天，月，季度，年来显示比特币的走势
fig = plt.figure(figsize=[15, 7])
plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;] # 用来正常显示中文标签
plt.suptitle(&#39;比特币金额（美金）&#39;, fontsize=20)
plt.subplot(221)
plt.plot(df.Weighted_Price, &#39;-&#39;, label=&#39;按天&#39;)
plt.legend()
plt.subplot(222)
plt.plot(df_month.Weighted_Price, &#39;-&#39;, label=&#39;按月&#39;)
plt.legend()
plt.subplot(223)
plt.plot(df_Q.Weighted_Price, &#39;-&#39;, label=&#39;按季度&#39;)
plt.legend()
plt.subplot(224)
plt.plot(df_year.Weighted_Price, &#39;-&#39;, label=&#39;按年&#39;)
plt.legend()
plt.show()
# 设置参数范围
ps = range(0, 3)
qs = range(0, 3)
parameters = product(ps, qs)
parameters_list = list(parameters)
# 寻找最优 ARMA 模型参数，即 best_aic 最小
results = []
best_aic = float(&quot;inf&quot;) # 正无穷
for param in parameters_list:
    try:
        model = ARMA(df_month.Weighted_Price,order=(param[0], param[1])).fit()
    except ValueError:
        print(&#39;参数错误:&#39;, param)
        continue
    aic = model.aic
    if aic &lt; best_aic:
        best_model = model
        best_aic = aic
        best_param = param
    results.append([param, model.aic])
# 输出最优模型
result_table = pd.DataFrame(results)
result_table.columns = [&#39;parameters&#39;, &#39;aic&#39;]
print(&#39;最优模型: &#39;, best_model.summary())
# 比特币预测
df_month2 = df_month[[&#39;Weighted_Price&#39;]]
date_list = [datetime(2018, 11, 30), datetime(2018, 12, 31), datetime(2019, 1, 31), datetime(2019, 2, 28), datetime(2019, 3, 31), 
             datetime(2019, 4, 30), datetime(2019, 5, 31), datetime(2019, 6, 30)]
future = pd.DataFrame(index=date_list, columns= df_month.columns)
df_month2 = pd.concat([df_month2, future])
df_month2[&#39;forecast&#39;] = best_model.predict(start=0, end=91)
# 比特币预测结果显示
plt.figure(figsize=(20,7))
df_month2.Weighted_Price.plot(label=&#39;实际金额&#39;)
df_month2.forecast.plot(color=&#39;r&#39;, ls=&#39;--&#39;, label=&#39;预测金额&#39;)
plt.legend()
plt.title(&#39;比特币金额（月）&#39;)
plt.xlabel(&#39;时间&#39;)
plt.ylabel(&#39;美金&#39;)
plt.show()


</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/03/18/数据挖掘实战（3）-：-如何对比特币走势进行预测/" data-id="ck3o5xx8m00458wujxuq42fd3"
         class="article-share-link">Share</a>
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据分析/">数据分析</a></li></ul>

    </footer>

  </div>

  
    
  <nav class="article-nav">
    
      <a href="/2019/04/04/hive-笔记/" class="article-nav-link">
        <strong class="article-nav-caption">Newer posts</strong>
        <div class="article-nav-title">
          
            hive 笔记
          
        </div>
      </a>
    
    
      <a href="/2019/03/16/Mysql-优化原理-笔记/" class="article-nav-link">
        <strong class="article-nav-caption">Olde posts</strong>
        <div class="article-nav-title">Mysql 优化原理 笔记</div>
      </a>
    
  </nav>


  

  
    
  

</article>



</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2019 上善若水博客</li>
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>Theme  <a href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>

</main>

<aside class="sidebar sidebar-specter">
  
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="上善若水博客"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">Home</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">Archives</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/gallery">Gallery</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">About</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="搜索">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/lazyload.min.js"></script>
<script src="/js/busuanzi-2.3.pure.min.js"></script>

  <script src="/fancybox/jquery.fancybox.min.js"></script>



  <script src="/js/tocbot.min.js"></script>
  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>


<script src="/js/ocean.js"></script>

</body>
</html>